ludus:
  # Windows 11 Malware Analysis Workstation 1
  - vm_name: "{{ range_id }}-malware-ws01"
    hostname: "{{ range_id }}-MAL-WS01"
    template: win11-22h2-x64-enterprise-template
    vlan: 10
    ip_last_octet: 10
    ram_gb: 8
    cpus: 4
    windows:
      sysprep: false
      install_additional_tools: true
      chocolatey_ignore_checksums: true
      chocolatey_packages:
        - notepadplusplus
        - 7zip
        - wireshark
        - procmon
        - autoruns
    testing:
      snapshot: true
      block_internet: false
    roles:
      - professor-moody.ludus_litterbox
    role_vars:
      ludus_litterbox_install: true
      ludus_litterbox_host: "0.0.0.0"  # Allow network access
      ludus_litterbox_port: 1337
      ludus_litterbox_disable_defender: true
      ludus_litterbox_analysis_timeout: 600  # 10 minutes
      ludus_litterbox_debug: false
      ludus_litterbox_enable_static: true
      ludus_litterbox_enable_dynamic: true
      ludus_litterbox_enable_yara: true

  # Windows Server 2022 Analysis Server
  - vm_name: "{{ range_id }}-malware-srv01"
    hostname: "{{ range_id }}-MAL-SRV01"
    template: win2022-server-x64-template
    vlan: 10
    ip_last_octet: 11
    ram_gb: 8
    cpus: 4
    windows:
      sysprep: false
      install_additional_tools: true
    testing:
      snapshot: true
      block_internet: false
    roles:
      - professor-moody.ludus_litterbox
    role_vars:
      ludus_litterbox_install: true
      ludus_litterbox_host: "0.0.0.0"
      ludus_litterbox_port: 8080  # Different port
      ludus_litterbox_disable_defender: true
      ludus_litterbox_install_dir: "D:\\Security\\LitterBox"
      ludus_litterbox_analysis_timeout: 900  # 15 minutes
      ludus_litterbox_workers: 6
      ludus_litterbox_max_file_size: 209715200  # 200MB
      ludus_litterbox_cleanup_days: 7  # Shorter retention

  # Windows 10 Isolated Analysis Box
  - vm_name: "{{ range_id }}-malware-iso01"
    hostname: "{{ range_id }}-MAL-ISO01"
    template: win10-22h2-x64-enterprise-template
    vlan: 10
    ip_last_octet: 12
    ram_gb: 4
    cpus: 2
    windows:
      sysprep: false
    testing:
      snapshot: true
      block_internet: true  # Isolated for dangerous samples
    roles:
      - professor-moody.ludus_litterbox
    role_vars:
      ludus_litterbox_install: true
      ludus_litterbox_host: "127.0.0.1"  # Local only
      ludus_litterbox_port: 1337
      ludus_litterbox_disable_defender: true
      ludus_litterbox_enable_dynamic: false  # Static only for isolation
      ludus_litterbox_debug: true
      ludus_litterbox_log_level: "DEBUG"
